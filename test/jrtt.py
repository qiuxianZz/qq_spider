import json
import time

import URLEncoder as URLEncoder
import requests


print(time.time())#获当前时间的时间戳
import time
t = time.time()
millis = int(round(time.time() * 1000))
# url = 'https://is-lq.snssdk.com/api/feed/forum_all/v1/?category=forum_topic_thread&query_id=1660661625260039&tab_id=1660661625261079&is_preview=0&stream_api_version=88&count=20&offset={}&app_extra_params=%7B%22from_page%22%3A%22topicsearch_hashtag_card%22%7D&client_extra_params=%7B%22playparam%22%3A%22codec_type%3A1%22%7D&iid=106932394204&device_id=56392426097&ac=wifi&mac_address=da%3A51%3A2e%3A03%3A62%3Aa3&channel=baidu_0411&aid=13&app_name=news_article&version_code=755&version_name=7.5.5&device_platform=android&ab_version=801968%2C1335893%2C1419053%2C668775%2C1462526%2C1529250%2C1529723%2C1190525%2C1157750%2C1157634%2C1419598%2C1493796%2C1439624%2C1469498%2C668779%2C662099%2C1504927%2C1502488%2C668774%2C1531102%2C821966%2C857803%2C660830%2C1526646%2C1434504%2C1527882%2C662176%2C1446849&ab_feature=102749%2C94563&ssmix=a&device_type=SM-G925F&device_brand=samsung&language=zh&os_api=22&os_version=5.1.1&uuid=867653234280434&openudid=2062042228145894&manifest_version_code=7550&resolution=720*1280&dpi=192&update_version_code=75515&_rticket=1583807924006&plugin=18762&tma_jssdk_version=1.46.0.12&rom_version=22&cdid=b7423b30-0d79-44e9-86ac-a799c705da8a'.format(40)
# url = 'https://is-lq.snssdk.com/api/feed/forum_hot/v1/?category=forum_hot_tab&query_id=1660661625260039&tab_id=1660661625260055&is_preview=0&stream_api_version=88&count=20&offset=20&app_extra_params=%7B%22enter_time%22%3A%221583807147%22%2C%22from_page%22%3A%22topicsearch_hashtag_card%22%7D&client_extra_params=%7B%22playparam%22%3A%22codec_type%3A1%22%7D&iid=106932394204&device_id=56392426097&ac=wifi&mac_address=da%3A51%3A2e%3A03%3A62%3Aa3&channel=baidu_0411&aid=13&app_name=news_article&version_code=755&version_name=7.5.5&device_platform=android&ab_version=801968%2C1335893%2C1419053%2C668775%2C1462526%2C1529250%2C1529723%2C1190525%2C1157750%2C1157634%2C1419598%2C1493796%2C1439624%2C1469498%2C668779%2C662099%2C1504927%2C1502488%2C668774%2C1531102%2C821966%2C857803%2C660830%2C1526646%2C1434504%2C1527882%2C662176%2C1446849&ab_feature=102749%2C94563&ssmix=a&device_type=SM-G925F&device_brand=samsung&language=zh&os_api=22&os_version=5.1.1&uuid=867653234280434&openudid=2062042228145894&manifest_version_code=7550&resolution=720*1280&dpi=192&update_version_code=75515&_rticket=1583807173677&plugin=18762&tma_jssdk_version=1.46.0.12&rom_version=22&cdid=b7423b30-0d79-44e9-86ac-a799c705da8a'
# url = 'https://is-lq.snssdk.com/api/feed/forum_hot/v1/?category=forum_hot_tab&query_id=1660661625260039&tab_id=1660661625260055&is_preview=0&stream_api_version=88&count=20&offset=20&app_extra_params=%7B%22enter_time%22%3A%221583808249%22%2C%22from_page%22%3A%22topicsearch_hashtag_card%22%7D&client_extra_params=%7B%22playparam%22%3A%22codec_type%3A1%22%7D&iid=106932394204&device_id=56392426097&ac=wifi&mac_address=da%3A51%3A2e%3A03%3A62%3Aa3&channel=baidu_0411&aid=13&app_name=news_article&version_code=755&version_name=7.5.5&device_platform=android&ab_version=801968%2C1335893%2C1419053%2C668775%2C1462526%2C1529250%2C1529723%2C1190525%2C1157750%2C1157634%2C1419598%2C1493796%2C1439624%2C1469498%2C668779%2C662099%2C1504927%2C1502488%2C668774%2C1531102%2C821966%2C857803%2C660830%2C1526646%2C1434504%2C1527882%2C662176%2C1446849&ab_feature=102749%2C94563&ssmix=a&device_type=SM-G925F&device_brand=samsung&language=zh&os_api=22&os_version=5.1.1&uuid=867653234280434&openudid=2062042228145894&manifest_version_code=7550&resolution=720*1280&dpi=192&update_version_code=75515&_rticket={}&plugin=18762&tma_jssdk_version=1.46.0.12&rom_version=22&cdid=b7423b30-0d79-44e9-86ac-a799c705da8a'.format(millis)
# url = 'https://is-lq.snssdk.com/api/feed/forum_all/v1/?category=forum_topic_thread&query_id=1660661625260039&tab_id=1660661625261079&is_preview=0&stream_api_version=88&count=20&offset={}&app_extra_params=%7B%22enter_time%22%3A%221583808553%22%2C%22from_page%22%3A%22topicsearch_hashtag_card%22%7D&client_extra_params=%7B%22playparam%22%3A%22codec_type%3A1%22%7D&iid=106932394204&device_id=56392426097&ac=wifi&mac_address=da%3A51%3A2e%3A03%3A62%3Aa3&channel=baidu_0411&aid=13&app_name=news_article&version_code=755&version_name=7.5.5&device_platform=android&ab_version=801968%2C1335893%2C1419053%2C668775%2C1462526%2C1529250%2C1529723%2C1190525%2C1157750%2C1157634%2C1419598%2C1493796%2C1439624%2C1469498%2C668779%2C662099%2C1504927%2C1502488%2C668774%2C1531102%2C821966%2C857803%2C660830%2C1526646%2C1434504%2C1527882%2C662176%2C1446849&ab_feature=102749%2C94563&ssmix=a&device_type=SM-G925F&device_brand=samsung&language=zh&os_api=22&os_version=5.1.1&uuid=867653234280434&openudid=2062042228145894&manifest_version_code=7550&resolution=720*1280&dpi=192&update_version_code=75515&_rticket={}&plugin=18762&tma_jssdk_version=1.46.0.12&rom_version=22&cdid=b7423b30-0d79-44e9-86ac-a799c705da8a'.format(20,millis)
# url = "https://is-lq.snssdk.com/api/feed/forum_all/v1/?category=forum_topic_thread&query_id=1660661625260039&tab_id=1660661625261079&is_preview=0&stream_api_version=88&count=20&offset=60&app_extra_params=%7B%22from_page%22%3A%22topicsearch_hashtag_card%22%7D&client_extra_params=%7B%22playparam%22%3A%22codec_type%3A1%22%7D&iid=106932394204&device_id=56392426097&ac=wifi&mac_address=da%3A51%3A2e%3A03%3A62%3Aa3&channel=baidu_0411&aid=13&app_name=news_article&version_code=755&version_name=7.5.5&device_platform=android&ab_version=668779%2C662099%2C1504927%2C1502488%2C668774%2C1531102%2C821966%2C857803%2C660830%2C1526646%2C1434504%2C1527882%2C662176%2C801968%2C1335893%2C1419053%2C668775%2C1462526%2C1529250%2C1529723%2C1190525%2C1157750%2C1157634%2C1419598%2C1493796%2C1439624%2C1469498%2C1446849&ab_feature=102749%2C94563&ssmix=a&device_type=SM-G925F&device_brand=samsung&language=zh&os_api=22&os_version=5.1.1&uuid=867653234280434&openudid=2062042228145894&manifest_version_code=7550&resolution=720*1280&dpi=192&update_version_code=75515&_rticket=1583824345981&plugin=18762&tma_jssdk_version=1.46.0.12&rom_version=22&cdid=b7423b30-0d79-44e9-86ac-a799c705da8a"
# url = "https://is-lq.snssdk.com/api/feed/forum_all/v1/?category=forum_topic_thread&query_id=1660661625260039&tab_id=1660661625261079&is_preview=0&stream_api_version=88&count=20&offset=40&app_extra_params=%7B%22enter_time%22%3A%221583824354%22%2C%22from_page%22%3A%22topicsearch_hashtag_card%22%7D&client_extra_params=%7B%22playparam%22%3A%22codec_type%3A1%22%7D&iid=106932394204&device_id=56392426097&ac=wifi&mac_address=da%3A51%3A2e%3A03%3A62%3Aa3&channel=baidu_0411&aid=13&app_name=news_article&version_code=755&version_name=7.5.5&device_platform=android&ab_version=668779%2C662099%2C1504927%2C1502488%2C668774%2C1531102%2C821966%2C857803%2C660830%2C1526646%2C1434504%2C1527882%2C662176%2C801968%2C1335893%2C1419053%2C668775%2C1462526%2C1529250%2C1529723%2C1190525%2C1157750%2C1157634%2C1419598%2C1493796%2C1439624%2C1469498%2C1446849&ab_feature=102749%2C94563&ssmix=a&device_type=SM-G925F&device_brand=samsung&language=zh&os_api=22&os_version=5.1.1&uuid=867653234280434&openudid=2062042228145894&manifest_version_code=7550&resolution=720*1280&dpi=192&update_version_code=75515&_rticket=1583824439543&plugin=18762&tma_jssdk_version=1.46.0.12&rom_version=22&cdid=b7423b30-0d79-44e9-86ac-a799c705da8a"
url = "https://is-lq.snssdk.com/api/feed/forum_all/v1/?category=forum_topic_thread&query_id=1660661625260039&tab_id=1660661625261079&is_preview=0&stream_api_version=88&count=20&offset=0&app_extra_params=%7B%22enter_time%22%3A%221583825370%22%2C%22from_page%22%3A%22topicsearch_hashtag_card%22%7D&client_extra_params=%7B%22playparam%22%3A%22codec_type%3A1%22%7D&iid=106932394204&device_id=56392426097&ac=wifi&mac_address=da%3A51%3A2e%3A03%3A62%3Aa3&channel=baidu_0411&aid=13&app_name=news_article&version_code=755&version_name=7.5.5&device_platform=android&ab_version=668779%2C662099%2C1504927%2C1502488%2C668774%2C1531102%2C821966%2C857803%2C660830%2C1526646%2C1434504%2C1527882%2C662176%2C801968%2C1335893%2C1419053%2C668775%2C1462526%2C1529250%2C1529723%2C1190525%2C1157750%2C1157634%2C1419598%2C1493796%2C1439624%2C1469498%2C1446849&ab_feature=102749%2C94563&ssmix=a&device_type=SM-G925F&device_brand=samsung&language=zh&os_api=22&os_version=5.1.1&uuid=867653234280434&openudid=2062042228145894&manifest_version_code=7550&resolution=720*1280&dpi=192&update_version_code=75515&_rticket={}&plugin=18762&tma_jssdk_version=1.46.0.12&rom_version=22&cdid=b7423b30-0d79-44e9-86ac-a799c705da8a".format(millis)
# url = "http://is.snssdk.com/api/feed/forum_all/v1/?category=forum_topic_thread&query_id=1660661625260039&tab_id=1660661625261079&is_preview=0&stream_api_version=88&count=20&offset=${result.offset}&app_extra_params=${if (isNull(result.appExtraParams)) "" else URLEncoder.encode(result.appExtraParams)}&client_extra_params=%7B%22playparam%22%3A%22codec_type%3A1%22%7D&iid=85747630323&device_id=66714875260&ac=wifi&channel=sem_baidu_pz&aid=13&app_name=news_article&version_code=741&version_name=7.4.1&device_platform=android&ab_version=801968%2C1335893%2C1419039%2C668775%2C1462526%2C1474415%2C1529251%2C1529720%2C1190525%2C1157750%2C1493795%2C1439625%2C1469498%2C668779%2C662099%2C1504928%2C668774%2C1531103%2C1479130%2C821966%2C857803%2C660830%2C1434502%2C1527882%2C662176&ab_group=100169%2C94563%2C102751&ab_feature=102751%2C94563&ssmix=a&device_type=Nexus+5&device_brand=google&language=zh&os_api=23&os_version=6.0.1&uuid=352136064458454&openudid=628d656c68bab256&manifest_version_code=741&resolution=1080*1776&dpi=480&update_version_code=74112&_rticket=1583827659052&fp=ilTZLSH1LWcbFlcOLrU1FYKeLlQq&tma_jssdk_version=1.33.1.1&pos=5r_-9Onkv6e_v7G_8fLz-vTp6Pn4v6esraizr6mkraqkpaSxv_H86fTp6Pn4v6eurbOopa2trKuurLG__PD87d706eS_p797FQ10HiB4JR-_sb_88Pzt0fLz-vTp6Pn4v6esramzra2lqKuvsb_88Pzt0fzp9Ono-fi_p66ts6uvq6-tquA%3D&rom_version=23&plugin=18762&cdid=615d19f9-87c1-44f1-992d-63f95fb5cf3b"
print(url)
"http://is.snssdk.com/api/feed/forum_all/v1/?category=forum_topic_thread&query_id=1660661625260039&tab_id=1660661625261079&is_preview=0&stream_api_version=88&count=20&offset=${result.offset}&app_extra_params=${if (isNull(result.appExtraParams)) "" else URLEncoder.encode(result.appExtraParams)}&client_extra_params=%7B%22playparam%22%3A%22codec_type%3A1%22%7D&iid=85747630323&device_id=66714875260&ac=wifi&channel=sem_baidu_pz&aid=13&app_name=news_article&version_code=741&version_name=7.4.1&device_platform=android&ab_version=801968%2C1335893%2C1419039%2C668775%2C1462526%2C1474415%2C1529251%2C1529720%2C1190525%2C1157750%2C1493795%2C1439625%2C1469498%2C668779%2C662099%2C1504928%2C668774%2C1531103%2C1479130%2C821966%2C857803%2C660830%2C1434502%2C1527882%2C662176&ab_group=100169%2C94563%2C102751&ab_feature=102751%2C94563&ssmix=a&device_type=Nexus+5&device_brand=google&language=zh&os_api=23&os_version=6.0.1&uuid=352136064458454&openudid=628d656c68bab256&manifest_version_code=741&resolution=1080*1776&dpi=480&update_version_code=74112&_rticket=1583827659052&fp=ilTZLSH1LWcbFlcOLrU1FYKeLlQq&tma_jssdk_version=1.33.1.1&pos=5r_-9Onkv6e_v7G_8fLz-vTp6Pn4v6esraizr6mkraqkpaSxv_H86fTp6Pn4v6eurbOopa2trKuurLG__PD87d706eS_p797FQ10HiB4JR-_sb_88Pzt0fLz-vTp6Pn4v6esramzra2lqKuvsb_88Pzt0fzp9Ono-fi_p66ts6uvq6-tquA%3D&rom_version=23&plugin=18762&cdid=615d19f9-87c1-44f1-992d-63f95fb5cf3b"
# url = "https://is-lq.snssdk.com/api/feed/forum_hot/v1/?category=forum_hot_tab&query_id=1660661625260039&tab_id=1660661625260055&is_preview=0&stream_api_version=88&count=20&offset=20&app_extra_params=%7B%22enter_time%22%3A%221583808553%22%2C%22from_page%22%3A%22topicsearch_hashtag_card%22%7D&client_extra_params=%7B%22playparam%22%3A%22codec_type%3A1%22%7D&iid=106932394204&device_id=56392426097&ac=wifi&mac_address=da%3A51%3A2e%3A03%3A62%3Aa3&channel=baidu_0411&aid=13&app_name=news_article&version_code=755&version_name=7.5.5&device_platform=android&ab_version=801968%2C1335893%2C1419053%2C668775%2C1462526%2C1529250%2C1529723%2C1190525%2C1157750%2C1157634%2C1419598%2C1493796%2C1439624%2C1469498%2C668779%2C662099%2C1504927%2C1502488%2C668774%2C1531102%2C821966%2C857803%2C660830%2C1526646%2C1434504%2C1527882%2C662176%2C1446849&ab_feature=102749%2C94563&ssmix=a&device_type=SM-G925F&device_brand=samsung&language=zh&os_api=22&os_version=5.1.1&uuid=867653234280434&openudid=2062042228145894&manifest_version_code=7550&resolution=720*1280&dpi=192&update_version_code=75515&_rticket=1583808561914&plugin=18762&tma_jssdk_version=1.46.0.12&rom_version=22&cdid=b7423b30-0d79-44e9-86ac-a799c705da8a"
# url = "https://is-lq.snssdk.com/api/feed/forum_hot/v1/?category=forum_hot_tab&query_id=1660661625260039&tab_id=1660661625260055&is_preview=0&stream_api_version=88&count=20&offset=40&app_extra_params=%7B%22enter_time%22%3A%221583808553%22%2C%22from_page%22%3A%22topicsearch_hashtag_card%22%7D&client_extra_params=%7B%22playparam%22%3A%22codec_type%3A1%22%7D&iid=106932394204&device_id=56392426097&ac=wifi&mac_address=da%3A51%3A2e%3A03%3A62%3Aa3&channel=baidu_0411&aid=13&app_name=news_article&version_code=755&version_name=7.5.5&device_platform=android&ab_version=801968%2C1335893%2C1419053%2C668775%2C1462526%2C1529250%2C1529723%2C1190525%2C1157750%2C1157634%2C1419598%2C1493796%2C1439624%2C1469498%2C668779%2C662099%2C1504927%2C1502488%2C668774%2C1531102%2C821966%2C857803%2C660830%2C1526646%2C1434504%2C1527882%2C662176%2C1446849&ab_feature=102749%2C94563&ssmix=a&device_type=SM-G925F&device_brand=samsung&language=zh&os_api=22&os_version=5.1.1&uuid=867653234280434&openudid=2062042228145894&manifest_version_code=7550&resolution=720*1280&dpi=192&update_version_code=75515&_rticket=1583808565072&plugin=18762&tma_jssdk_version=1.46.0.12&rom_version=22&cdid=b7423b30-0d79-44e9-86ac-a799c705da8a"
headers = {
    # "Accept-Encoding": "gzip",
    # "X-SS-REQ-TICKET": str(millis),
    # "passport-sdk-version": "8",
    # "sdk-version": "2",
    "User-Agent": "ttnet okhttp/3.10.0.2",
    # "Cookie": "install_id=106932394204; ttreq=1$1f6ba82a2c5edbbb64a99f1f595c6fafd3b651af; odin_tt=d22d33b31772c283e2051c6baf9544848db93fa1387f287841755e05f8743b516aea996375c805eb07fc324aff479434; history=alrvlFic6pJZXJCTWBmSmZt6KS7txZWlniWpucWdl%2BMSz9dsYWDiucTVw%2BBwOS5xfsXJA0zMl1jdQLw0VvupDkx8lxgYwLwMxYQDTHyX%2BAQYAi7HpYWrJDUw8VxibgHJJfSYCjIwMV9i5wDxUg8e%2B9LAxHyJ8RBYn%2ByW1QeY2C%2Fx%2BIH0JQVemdfAxHCJ4xSDAwAAAP%2F%2F; qh[360]=1; WIN_WH=600_986",
    # "X-Gorgon": "040160ed4005a626b308e977de86f93648df56882c9d0f736035",
    # "X-Khronos": str(int(t)),
    # "Host": "is-lq.snssdk.com",
    # "Connection": "Keep-Alive"


}




url = "http://is.snssdk.com/api/feed/forum_all/v1/?category=forum_topic_thread&query_id=1660661625260039&tab_id=1660661625261079&is_preview=0&stream_api_version=88&count=20&offset="+offset+"&app_extra_params=" + URLEncoder.encode({"enter_time":"1583831790"}) +"&client_extra_params=%7B%22playparam%22%3A%22codec_type%3A1%22%7D&iid=85747630323&device_id=66714875260&ac=wifi&channel=sem_baidu_pz&aid=13&app_name=news_article&version_code=741&version_name=7.4.1&device_platform=android&ab_version=801968%2C1335893%2C1419039%2C668775%2C1462526%2C1474415%2C1529251%2C1529720%2C1190525%2C1157750%2C1493795%2C1439625%2C1469498%2C668779%2C662099%2C1504928%2C668774%2C1531103%2C1479130%2C821966%2C857803%2C660830%2C1434502%2C1527882%2C662176&ab_group=100169%2C94563%2C102751&ab_feature=102751%2C94563&ssmix=a&device_type=Nexus+5&device_brand=google&language=zh&os_api=23&os_version=6.0.1&uuid=352136064458454&openudid=628d656c68bab256&manifest_version_code=741&resolution=1080*1776&dpi=480&update_version_code=74112&_rticket=1583827659052&fp=ilTZLSH1LWcbFlcOLrU1FYKeLlQq&tma_jssdk_version=1.33.1.1&pos=5r_-9Onkv6e_v7G_8fLz-vTp6Pn4v6esraizr6mkraqkpaSxv_H86fTp6Pn4v6eurbOopa2trKuurLG__PD87d706eS_p797FQ10HiB4JR-_sb_88Pzt0fLz-vTp6Pn4v6esramzra2lqKuvsb_88Pzt0fzp9Ono-fi_p66ts6uvq6-tquA%3D&rom_version=23&plugin=18762&cdid=615d19f9-87c1-44f1-992d-63f95fb5cf3b"
print(url)
res = requests.get(url,headers=headers)
print(res.text)





con = json.loads(res.text)
data = con["data"]
for item in data:
    content = item["content"]
    # print(content["data"])
    con = json.loads(content)
    try:
        data = (con["data"])
        content = data["content"]
        print(content)
    except KeyError:
        continue

